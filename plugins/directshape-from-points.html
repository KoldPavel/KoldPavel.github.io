<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>DirectShape из точек — плагины Павла Колдунова</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../assets/plugins.css" />
</head>
<body>
  <header class="page-header">
    <div class="lang-switcher" role="group" aria-label="Language switcher">
      <button type="button" class="is-active" data-lang="ru">РУС</button>
      <button type="button" data-lang="en">ENG</button>
    </div>
    <div class="header-content">
      <a class="back-link" href="../index.html#projects" data-i18n="backLink">← Ко всем плагинам</a>
      <h1 class="page-title" data-i18n="title">DirectShape из точек</h1>
      <p class="page-subtitle" data-i18n="subtitle">Построение КЭ схемы в Revit по CSV/XLSX из ЛИРЫ</p>
    </div>
  </header>

  <main>
    <section class="section plugin-panel-section" aria-label="Быстрый переход к другим плагинам">
      <h2 data-i18n="allPlugins">Все плагины</h2>
      <div class="plugin-panel" role="group" aria-label="Плагины Revit">
        <div class="plugin-group plugin-group--views" aria-label="Работа с видами">
          <p class="plugin-group-title" data-i18n="viewsGroup">Работа с видами</p>
          <div class="plugin-group-buttons">
            <a class="plugin-button" href="create-sections.html" aria-label="Создание видов">
              <img src="../assets/Icons/CreateSections.png" alt="CreateSections" />
              <span class="plugin-title" data-i18n="pluginCreateSections">Создание<br />видов</span>
            </a>
            <a class="plugin-button" href="view-design.html" aria-label="Оформление видов">
              <img src="../assets/Icons/ViewDesign.png" alt="View Design" />
              <span class="plugin-title" data-i18n="pluginViewDesign">Оформление<br />видов</span>
            </a>
          </div>
        </div>
        <div class="plugin-group plugin-group--rebar" aria-label="Армирование и анализ">
          <p class="plugin-group-title" data-i18n="rebarGroup">Армирование и анализ</p>
          <div class="plugin-group-buttons">
            <a class="plugin-button" href="intersection-hosts.html" aria-label="Назначить хосты DS">
              <img src="../assets/Icons/Intersection.png" alt="Intersection" />
              <span class="plugin-title" data-i18n="pluginIntersectionHosts">Назначить<br />хосты DS</span>
            </a>
            <a class="plugin-button" href="path-reinforcement.html" aria-label="Дополнительное армирование">
              <img src="../assets/Icons/PathReinf.png" alt="Path Reinforcement" />
              <span class="plugin-title" data-i18n="pluginPathReinforcement">Дополнительное<br />армирование</span>
            </a>
            <a class="plugin-button" href="results-viewer.html" aria-label="Просмотр результатов">
              <img src="../assets/Icons/Results.png" alt="Results" />
              <span class="plugin-title" data-i18n="pluginResultsViewer">Просмотр<br />результатов</span>
            </a>
            <a class="plugin-button" href="directshape-from-points.html" aria-label="DirectShape из точек">
              <img src="../assets/Icons/RevitDirectShape.png" alt="Revit DirectShape" />
              <span class="plugin-title" data-i18n="pluginDirectshape">DirectShape<br />из точек</span>
            </a>
          </div>
        </div>
      </div>
    </section>

    <div class="plugin-hero">
      <div class="plugin-icon">
        <img src="../assets/Icons/RevitDirectShape.png" alt="Иконка плагина DirectShape из точек" width="60" height="60" />
      </div>
      <div>
        <div class="badge" data-i18n="badge">Обмен данными</div>
        <p data-i18n="heroText">
          Плагин строит КЭ схему в модели Revit, повторяя расчётную схему из ЛИРЫ по таблицам CSV или XLSX. Он создаёт параметры проекта
          для категории «Антураж» и записывает в них значения армирования каждого КЭ.
        </p>
      </div>
    </div>

    <section class="section">
      <h2 data-i18n="featuresTitle">Ключевые возможности</h2>
      <ul data-i18n="featuresList">
        <li>Построение КЭ схемы в Revit по таблицам CSV/XLSX из ЛИРЫ.</li>
        <li>Запись результатов армирования в КЭ. Можно перезаписать значения по ранее созданной схеме.</li>
        <li>Создание КЭ в виде DirectShape в категории «Антураж» с заполнением параметров армирования.</li>
      </ul>
    </section>

    <section class="section">
      <h2 data-i18n="screenshotsTitle">Скриншоты</h2>
      <div class="screenshot-grid">
        <figure>
          <img src="../assets/Screenshots/DirectShape/DirectShape.png" alt="Импорт геометрии из таблиц" />
          <figcaption data-i18n="caption1">Окно плагина. Построение элементов DirectShape по пластинам и координатам их узлов.</figcaption>
        </figure>
        <figure>
          <img src="../assets/Screenshots/DirectShape/DirectShape_2.png" alt="Заполнение параметров армирования" />
          <figcaption data-i18n="caption2">Созданные параметры проекта заполняются значениями армирования.</figcaption>
        </figure>
      </div>
    </section>
  </main>

  <div class="lightbox" aria-hidden="true" role="dialog" aria-label="Просмотр скриншотов" data-i18n="lightboxAria">
    <div class="lightbox__dialog">
      <button class="lightbox__close" type="button" aria-label="Закрыть просмотр" data-i18n="lightboxClose">×</button>
      <div class="lightbox__image-wrapper">
        <img class="lightbox__image" src="" alt="" />
      </div>
      <p class="lightbox__caption"></p>
      <div class="lightbox__controls">
        <div class="lightbox__buttons">
          <button class="lightbox__button" type="button" data-direction="prev" data-i18n="lightboxPrev">← Назад</button>
          <button class="lightbox__button" type="button" data-direction="next" data-i18n="lightboxNext">Вперед →</button>
        </div>
        <span class="lightbox__counter" aria-live="polite"></span>
      </div>
    </div>
  </div>

  <script src="../assets/lang-switcher.js"></script>
  <script>
    const translations = {
      ru: {
        backLink: "← Ко всем плагинам",
        title: "DirectShape из точек",
        subtitle: "Построение КЭ схемы в Revit по CSV/XLSX из ЛИРЫ",
        allPlugins: "Все плагины",
        viewsGroup: "Работа с видами",
        rebarGroup: "Армирование и анализ",
        pluginCreateSections: "Создание<br />видов",
        pluginViewDesign: "Оформление<br />видов",
        pluginIntersectionHosts: "Назначить<br />хосты DS",
        pluginPathReinforcement: "Дополнительное<br />армирование",
        pluginResultsViewer: "Просмотр<br />результатов",
        pluginDirectshape: "DirectShape<br />из точек",
        badge: "Обмен данными",
        heroText:
          "Плагин строит КЭ схему в модели Revit, повторяя расчётную схему из ЛИРЫ по таблицам CSV или XLSX. Он создаёт параметры проекта для категории «Антураж» и записывает в них значения армирования каждого КЭ.",
        featuresTitle: "Ключевые возможности",
        featuresList:
          "<li>Построение КЭ схемы в Revit по таблицам CSV/XLSX из ЛИРЫ.</li>" +
          "<li>Запись результатов армирования в КЭ. Можно перезаписать значения по ранее созданной схеме.</li>" +
          "<li>Создание КЭ в виде DirectShape в категории «Антураж» с заполнением параметров армирования.</li>",
        screenshotsTitle: "Скриншоты",
        caption1: "Окно плагина. Построение элементов DirectShape по пластинам и координатам их узлов.",
        caption2: "Созданные параметры проекта заполняются значениями армирования.",
        lightboxAria: "Просмотр скриншотов",
        lightboxClose: "×",
        lightboxPrev: "← Назад",
        lightboxNext: "Вперед →",
      },
      en: {
        backLink: "← Back to all plugins",
        title: "DirectShape from points",
        subtitle: "Build an FE model in Revit from LIRA CSV/XLSX tables",
        allPlugins: "All plugins",
        viewsGroup: "Views",
        rebarGroup: "Reinforcement and analysis",
        pluginCreateSections: "Create<br />sections",
        pluginViewDesign: "View<br />styling",
        pluginIntersectionHosts: "Assign<br />DS hosts",
        pluginPathReinforcement: "Additional<br />reinforcement",
        pluginResultsViewer: "Results<br />viewer",
        pluginDirectshape: "DirectShape<br />from points",
        badge: "Data exchange",
        heroText:
          "The plugin builds an FE model in Revit to mirror the LIRA analytical model from CSV or XLSX tables. It creates project parameters for the Entourage category and writes reinforcement values for each element into them.",
        featuresTitle: "Key capabilities",
        featuresList:
          "<li>Build an FE model in Revit using LIRA CSV/XLSX tables.</li>" +
          "<li>Write reinforcement results into the FE elements and update previously created schemes.</li>" +
          "<li>Create FE elements as DirectShapes in the Entourage category and populate reinforcement parameters.</li>",
        screenshotsTitle: "Screenshots",
        caption1: "Plugin window. Build DirectShape elements from plates and their node coordinates.",
        caption2: "Created project parameters are filled with reinforcement values.",
        lightboxAria: "Screenshot viewer",
        lightboxClose: "×",
        lightboxPrev: "← Previous",
        lightboxNext: "Next →",
      },
    };

    initLanguageSwitcher(translations);

    (() => {
      const figures = Array.from(document.querySelectorAll(".screenshot-grid figure"));
      if (!figures.length) return;

      const lightbox = document.querySelector(".lightbox");
      const lightboxImage = lightbox.querySelector(".lightbox__image");
      const lightboxCaption = lightbox.querySelector(".lightbox__caption");
      const lightboxCounter = lightbox.querySelector(".lightbox__counter");
      const closeButton = lightbox.querySelector(".lightbox__close");
      const prevButton = lightbox.querySelector('[data-direction="prev"]');
      const nextButton = lightbox.querySelector('[data-direction="next"]');

      const images = figures.map((figure) => {
        const img = figure.querySelector("img");
        const caption = figure.querySelector("figcaption");
        img.tabIndex = 0;
        return {
          img,
          caption: caption ? caption.textContent.trim() : "",
        };
      });

      let currentIndex = 0;

      function updateViewer(index) {
        const { img, caption } = images[index];
        lightboxImage.src = img.src;
        lightboxImage.alt = img.alt || "Скриншот";
        lightboxCaption.textContent = caption;
        lightboxCounter.textContent = `${index + 1} / ${images.length}`;
      }

      function openViewer(index) {
        currentIndex = index;
        updateViewer(currentIndex);
        lightbox.classList.add("open");
        lightbox.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden";
        closeButton.focus();
      }

      function closeViewer() {
        lightbox.classList.remove("open");
        lightbox.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
      }

      function showRelative(step) {
        currentIndex = (currentIndex + step + images.length) % images.length;
        updateViewer(currentIndex);
      }

      figures.forEach((figure, index) => {
        const img = figure.querySelector("img");
        const open = () => openViewer(index);

        figure.addEventListener("click", open);
        figure.addEventListener("keydown", (event) => {
          if (event.key === "Enter" || event.key === " ") {
            event.preventDefault();
            open();
          }
        });
        img.setAttribute("role", "button");
        img.setAttribute("aria-label", img.alt || "Открыть скриншот");
      });

      closeButton.addEventListener("click", closeViewer);
      lightbox.addEventListener("click", (event) => {
        if (event.target === lightbox) {
          closeViewer();
        }
      });

      prevButton.addEventListener("click", () => showRelative(-1));
      nextButton.addEventListener("click", () => showRelative(1));

      window.addEventListener("keydown", (event) => {
        if (!lightbox.classList.contains("open")) return;
        if (event.key === "Escape") {
          closeViewer();
        } else if (event.key === "ArrowRight") {
          showRelative(1);
        } else if (event.key === "ArrowLeft") {
          showRelative(-1);
        }
      });
    })();
  </script>
</body>
</html>
